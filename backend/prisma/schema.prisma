// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
 
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  APPLICANT
  SCHOLAR
}

model User {
  id            String         @id @default(uuid())
  //id, gradeSlip, eslip, ncae, ebill, wbill, tbill, bcert, indigency, autobiograpahy, pantawidId, sketchAddress 
  image         String?
  fname         String
  mname         String
  lname         String
  username      String?
  email         String         @unique
  password      String?
  address       String
  idPicture     String?
  gradeSlip     String?
  eslip         String?
  ncae          String?
  ebill         String?
  wbill         String?
  tbill         String?
  bcert         String?
  indigency     String?
  autobiography String?
  pantawidId    String?
  sketchAdress  String?
  year          String?
  school        String?
  program       String?
  role          Role           @default(APPLICANT)
  room          Room[]
  message       Messages[]
  refreshToken  RefreshToken[]

  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model RefreshToken {
  id          String   @id @default(uuid())
  hashedToken String
  userId      String
  revoked     Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  User        User     @relation(fields: [userId], references: [id])
}

model Calendar {
  id          String @unique
  title       String
  description String
  label       String
  day         Int
}

model Room {
  id      String   @id @default(uuid())
  userId  String   @unique
  latest String? 
  user    User     @relation(fields: [userId], references: [id])
  message Messages[] @relation("messages")
  latestMessage  Messages?   @relation("room", fields: [latest], references: [id])
}

model Messages {
 id      String   @id @default(uuid())
 userId  String
 roomId  String  
 message String
 image   String
 created DateTime  @default(now())
 modified DateTime @default(now())
 room    Room     @relation("messages",fields: [roomId], references: [id])
 room2   Room[]   @relation("room")  
 user    User     @relation(fields: [userId], references: [id])
}